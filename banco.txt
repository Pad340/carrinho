create database carrinho;

CREATE TABLE `itenspedido` (
  `item_id` int(11) NOT NULL,
  `produto_id` int(11) NOT NULL,
  `pedido_id` int(11) NOT NULL,
  `quantidade` double NOT NULL,
  `valor_unitario` float(10,2) NOT NULL,
  `valor_total` float(10,2) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `pedido` (
  `pedido_id` int(11) NOT NULL,
  `valor_total` float(10,2) NOT NULL,
  `data` datetime NOT NULL DEFAULT current_timestamp(),
  `status` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `produto` (
  `produto_id` int(11) NOT NULL,
  `nome` varchar(150) CHARACTER SET latin1 COLLATE latin1_swedish_nopad_ci NOT NULL,
  `valor` float(10,2) NOT NULL,
  `quantidade` int(11) NOT NULL DEFAULT 1
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

ALTER TABLE `itenspedido`
  ADD PRIMARY KEY (`item_id`),
  ADD KEY `fk_produto` (`produto_id`),
  ADD KEY `fk_pedido` (`pedido_id`);


ALTER TABLE `pedido`
  ADD PRIMARY KEY (`pedido_id`);


ALTER TABLE `produto`
  ADD PRIMARY KEY (`produto_id`);
  
  ALTER TABLE `itenspedido`
  ADD CONSTRAINT `fk_pedido` FOREIGN KEY (`pedido_id`) REFERENCES `pedido` (`pedido_id`),
  ADD CONSTRAINT `fk_produto` FOREIGN KEY (`produto_id`) REFERENCES `produto` (`produto_id`);
COMMIT;